clear;
clc;
%% CCC
global N1 N2 L_1 L_2 L_w O

N1=6;
N2=6;

A_1=[0 1 1 0 0 1;
    1 0 1 0 0 1;
    1 1 0 1 0 0;
    0 0 1 0 1 0;
    0 0 0 1 0 1;
    1 1 0 0 1 0];
L_1=diag(sum(A_1,2))-A_1;
A_2=[0 1 0 1 0 1;
    1 0 1 0 0 0;
    0 1 0 1 0 0;
    1 0 1 0 1 0;
    0 0 0 1 0 1;
    1 0 0 0 1 0];
L_2=diag(sum(A_2,2))-A_2;

A_w=[0	1	0	0	0	0	0	0	0	0	0	1;
    1	0	1	0	0	0	0	0	0	0	0	0;
    0	1	0	1	0	0	0	0	0	0	0	1;
    0	0	1	0	1	0	0	0	0	0	0	0;
    0	0	0	1	0	1	0	0	0	1	0	0;
    0	0	0	0	1	0	1	0	0	0	0	0;
    0	0	0	0	0	1	0	1	0	0	0	0;
    0	0	0	0	0	0	1	0	1	0	0	0;
    0	0	0	0	0	0	0	1	0	1	0	0;
    0	0	0	0	1	0	0	0	1	0	1	0;
    0	0	0	0	0	0	0	0	0	1	0	1;
    1	0	1	0	0	0	0	0	0	0	1	0];
L_w=diag(sum(A_w,2))-A_w;
O=kron(diag(A_w(:)),eye(3));

%% KK
global R_1 R_2 G_1 G_2
R11=kron([1,0,0,0,0,0],eye(3));R12=kron([0,1,0,0,0,0],eye(3));
R13=kron([0,0,1,0,0,0],eye(3));R14=kron([0,0,0,1,0,0],eye(3));
R15=kron([0,0,0,0,1,0],eye(3));R16=kron([0,0,0,0,0,1],eye(3));
R_1=blkdiag(R11,R12,R13,R14,R15,R16);
R_2=R_1;

G_ij=[1 0 0];
G_1=kron(eye(6),G_ij);
G_2=-G_1;

%% Initial Value
Data_Num=14*N1+2*N1^2*3;
tspan=[0 20];
eta1_init=[-500;-500;0;-500;-300;0;-500;-100;0;-500;100;0;-500;300;0;-500;500;0];
eta2_init=[500;-500;0;500;-300;0;500;-100;0;500;100;0;500;300;0;500;500;0];

z0=zeros(1272,1);
z0(1:18)=eta1_init;
z0(Data_Num+1:Data_Num+18)=eta2_init;

NUM_USV=Data_Num+14*N2+2*N2^2*3+432;
z0(NUM_USV+1:NUM_USV+36)=z0(1:36);

[t,z]=ode45(@df_USVSWARM,tspan,z0);

Position_USV=z(:,NUM_USV+1:NUM_USV+36);

% save z
save t
save Position_USV